# load UIAutomation types
Add-Type -AssemblyName UIAutomationClient

# 1. find the main dialog by its Window Name
$root = [System.Windows.Automation.AutomationElement]::RootElement
$dlg  = $root.FindFirst(
    [System.Windows.Automation.TreeScope]::Children,
    (New-Object System.Windows.Automation.PropertyCondition(
        [System.Windows.Automation.AutomationElement]::NameProperty,
        "BigFix Support Center"
    ))
)
if (-not $dlg) { throw "❌ Dialog 'BigFix Support Center' not found" }

# 2. find the Tab control under that dialog
$tab = $dlg.FindFirst(
    [System.Windows.Automation.TreeScope]::Descendants,
    (New-Object System.Windows.Automation.PropertyCondition(
        [System.Windows.Automation.AutomationElement]::ControlTypeProperty,
        [System.Windows.Automation.ControlType]::Tab
    ))
)
if (-not $tab) { throw "❌ Tab control not found" }

# 3. collect all TabItem children, pick the one named "NSD - Get Help"
$items = $tab.FindAll(
    [System.Windows.Automation.TreeScope]::Children,
    (New-Object System.Windows.Automation.PropertyCondition(
        [System.Windows.Automation.AutomationElement]::ControlTypeProperty,
        [System.Windows.Automation.ControlType]::TabItem
    ))
)

$nsdTab = $items | Where-Object { $_.Current.Name -eq "NSD - Get Help" }
if (-not $nsdTab) { throw "❌ TabItem 'NSD - Get Help' not found" }

# 4. select it via SelectionItemPattern
$sel = $nsdTab.GetCurrentPattern(
    [System.Windows.Automation.SelectionItemPattern]::Pattern
)
if ($sel) {
    $sel.Select()
    "✅ Tab 'NSD - Get Help' has been selected."
} else {
    throw "❌ SelectionItemPattern not available on that TabItem."
}